<!DOCTYPE html>
<html>
  <head>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"c888a78c33","applicationID":"1778417","transactionName":"dF1fF0NfXgoBRBYBC0JAQgZCH0ESAUZKTRdfXUY=","queueTime":7,"applicationTime":659,"agent":"js-agent.newrelic.com/nr-768.min.js"}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({QJf3ax:[function(e,n){function t(e){function n(n,t,a){e&&e(n,t,a),a||(a={});for(var u=c(n),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,t);return s}function a(e,n){f[e]=c(e).concat(n)}function c(e){return f[e]||[]}function u(){return t(n)}var f={};return{on:a,emit:n,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=e("gos");n.exports=t()},{gos:"7eSDFh"}],ee:[function(e,n){n.exports=e("QJf3ax")},{}],3:[function(e,n){function t(e){return function(){r(e,[(new Date).getTime()].concat(i(arguments)))}}var r=e("handle"),o=e(1),i=e(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(e,n){window.NREUM[n]=t("api-"+n)}),n.exports=window.NREUM},{1:12,2:13,handle:"D5DuLP"}],gos:[function(e,n){n.exports=e("7eSDFh")},{}],"7eSDFh":[function(e,n){function t(e,n,t){if(r.call(e,n))return e[n];var o=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return e[n]=o,o}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],D5DuLP:[function(e,n){function t(e,n,t){return r.listeners(e).length?r.emit(e,n,t):void(r.q&&(r.q[e]||(r.q[e]=[]),r.q[e].push(n)))}var r=e("ee").create();n.exports=t,t.ee=r,r.q={}},{ee:"QJf3ax"}],handle:[function(e,n){n.exports=e("D5DuLP")},{}],XL7HBI:[function(e,n){function t(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:i(e,o,function(){return r++})}var r=1,o="nr@id",i=e("gos");n.exports=t},{gos:"7eSDFh"}],id:[function(e,n){n.exports=e("XL7HBI")},{}],G9z0Bl:[function(e,n){function t(){var e=d.info=NREUM.info,n=f.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&n){c(p,function(n,t){n in e||(e[n]=t)});var t="https"===s.split(":")[0]||e.sslForHttp;d.proto=t?"https://":"http://",a("mark",["onload",i()]);var r=f.createElement("script");r.src=d.proto+e.agent,n.parentNode.insertBefore(r,n)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=e("handle"),c=e(1),u=window,f=u.document;e(2);var s=(""+location).split("?")[0],p={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-768.min.js"},d=n.exports={offset:i(),origin:s,features:{}};f.addEventListener?(f.addEventListener("DOMContentLoaded",o,!1),u.addEventListener("load",t,!1)):(f.attachEvent("onreadystatechange",r),u.attachEvent("onload",t)),a("mark",["firstbyte",i()])},{1:12,2:3,handle:"D5DuLP"}],loader:[function(e,n){n.exports=e("G9z0Bl")},{}],12:[function(e,n){function t(e,n){var t=[],o="",i=0;for(o in e)r.call(e,o)&&(t[i]=n(o,e[o]),i+=1);return t}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],13:[function(e,n){function t(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(0>o?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=t},{}]},{},["G9z0Bl"]);</script>
    <script src="//cdn.optimizely.com/js/264183567.js"></script>
<title>Authorization: Who can? Who can&#39;t? | One Month Rails</title>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="SM7EgM/BESsu52diewvwt5D5Nqkyti3H/yJ9KboDKOLD0asw0X34yT2bLOppic5X9gsApLrhShfldvHxNysrrA==" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="google-site-verification" content="fFlO9XLB0aY_MWUpp3bA6UXu61YcWE0ARuwlhk-bKDM" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://onemonth.com/blog.rss" />


<link rel="shortcut icon" type="image/x-icon" href="https://d3dcc53t14pv6.cloudfront.net/assets/favicon-om-54c39c33ac65875f477083c5bea80992.ico" />

<script>
  var OM = window.OM = {"env":"production","segment_io_key":"z56je8icne","just_signed_up":null,"one_month_root":"https://onemonth.com/","user":{"id":26760,"name":"sergio","email":"serxhio.z@gmail.com","plan":"Steady Plan","created_at":"2015-11-30T19:38:29.264-05:00","intercom_hash":"a9896429fe10bde53af89c8c5d29b7b4d3b079ff441df20bb4e4dfd83558bbb1","lifecyclestage":"customer"}};
  
</script>

<script src="https://www.google.com/jsapi"></script>
<script src="https://d3dcc53t14pv6.cloudfront.net/assets/application-f1b4886125de41933f53ab3655be26d8.js"></script>

  <script src="https://js.stripe.com/v2/"></script>

<!--[if lt IE 9]>
<script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


  <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>


<link rel="stylesheet" media="all" href="https://d3dcc53t14pv6.cloudfront.net/assets/application-0e955aa7f278f223ec433b3f30f8f5c8.css" data-turbolinks-track="true" />
<link rel="stylesheet" media="all" href="//cloud.typography.com/6988732/736588/css/fonts.css" data-turbolinks-track="true" />
<style></style>
  <link rel="stylesheet" media="all" href="//onemonth.com/courses/one-month-rails/stylesheet.css?1447086366" />

  </head>
  <body class="">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    
    



    <header class="navbar navbar-default navbar-static-top border-tertiary" role="navigation">
  <div class="container-fluid">

    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button

      <!-- logo -->
          <a class="navbar-brand" href="/courses/one-month-rails">
            <img alt="One Month" class="navbar-brand-icon" src="https://d3dcc53t14pv6.cloudfront.net/assets/logo-one-month-blue-646fe2fe19522260fdb9a84ed5b534ba.svg" />
            <span style="color: #f06745">| Rails</span>
</a>    </div>

    <!-- Everything you want hidden at 940px or less, place within here -->
    <nav class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
          <li ><a href="/courses">Dashboard</a></li>
            <li ><a href="/courses/one-month-rails">Course Progress</a></li>

          <li><a href="/community">Forum</a></li>
          <li><a>|</a></li>
          <li class="dropdown">
            <a id="user-dropdown" data-toggle="dropdown" href="#">
              Hi, sergio
            <img class="img-circle img-avatar-24" src="https://d3dcc53t14pv6.cloudfront.net/images/avatars/thumb/missing.png" alt="Missing" />
            </a>
            <ul class="dropdown-menu">
                <li><a href="/subscription/change"><span class="fa fa-plus-circle"></span>Upgrade Now!</a></li>
              <li><a href="/users/edit">Manage Account</a></li>
              <li><a rel="nofollow" data-method="delete" href="/signout">Sign out</a></li>
            </ul>
          </li>
      </ul>
    </nav>
  </div>
</header>

    
    


  <div class="video-container">
    <div class="video-wrapper clearfix">
  <div class="wistia_embed" id="wistia_end8hdu4tm"><script src="https://fast.wistia.net/static/E-v1.js"></script><script>
//<![CDATA[
wistiaEmbed = Wistia.embed("end8hdu4tm", {
          videoFoam: true,
          videoWidth: 1920,
          videoHeight: 1080,
          videoQuality: 'hd-only',
          controlsVisibleOnLoad: false,
          plugin: {
            midrollLinks: {
              src:"https://fast.wistia.com/labs/mid-roll-links/plugin.js"
            }
          }
        });
wistiaEmbed.play();
//]]>
</script></div>
</div>

<div class="text-center">
  <ul class="nav nav-pills centered-pills" id="playback_speeds" style="display:none;" data-speed="1.25" data-name="1.25x">
      <li><a data-toggle="tooltip" data-behavior="skip-backward" title="Skip backward 30 seconds" href="#"><i class="fa fa-backward"></i></a></li>
      <li class="dropdown">
        <a id="playback_speed_drop" role="button" data-toggle="dropdown" href="#">Speed <span class="caret"></span></a>
        <ul id="playback_speed_menu" class="dropdown-menu" role="menu" aria-labelledby="playback_speed_drop">
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="0.5" data-name="Drunk Mode" href="#">Drunk Mode</a>
            </li>
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="0.75" data-name="0.75x" href="#">0.75x</a>
            </li>
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="1.0" data-name="1x" href="#">1x</a>
            </li>
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="1.25" data-name="1.25x" href="#">1.25x</a>
            </li>
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="1.5" data-name="1.5x" href="#">1.5x</a>
            </li>
            <li role="presentation">
              <a tabindex="-1" role="menuitem" data-speed="2.0" data-name="2x" href="#">2x</a>
            </li>
        </ul>
      </li>
      <li><a data-toggle="tooltip" data-behavior="skip-forward" title="Skip forward 30 Seconds" href="#"><i class="fa fa-forward"></i></a></li>

  </ul>
</div>

  </div>
  <div class="container step-container">
    <h1>Authorization: Who can? Who can&#39;t?</h1>
    <p class="text-muted"><small>Day 23 · Lesson 1</small></p>
    <div class="tabbable">
      <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#step-notes">Lesson Notes</a></li>
          <li><a data-toggle="tab" href="#troubleshooting">Troubleshooting</a></li>
        <li><a data-toggle="tab" href="#comments">28 Questions</a></li>
        <li class="pull-right"><form action="/courses/one-month-rails/steps/pins-authorization/complete" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="uvc5BMHBxDIdsa92SBsHgP6hPs7Mw5Cpla9e0/C7ey0x6Fa0330t0A7N5P5amTlgmFMIw0SU93mP+9ILfZN4Yw==" /><button name="button" type="submit" class="btn complete-btn one-month-rails" data-disable-with="&lt;i class=&#39;fa fa-spinner fa-spin&#39;&gt;&lt;/i&gt; Completing...">Complete &amp; Continue</button></form></li>
      </ul>

      <div class="tab-content">
        <div class="tab-pane active" id="step-notes">
          <br>
          <p class="lead">In this lesson you'll add authorization (so that a user can't delete another user's pins).</p>

          <div id="step-content">
              <p style="margin-bottom: 30px;"><a href="https://github.com/onemonthrails/pinteresting/tree/7b109d497e56c829ae0a4e1a7bd1e654b99815b9" target="_blank"><i class="icon-github" style="font-size: 24px;"></i></a> <a href="https://github.com/onemonthrails/pinteresting/tree/7b109d497e56c829ae0a4e1a7bd1e654b99815b9" target="_blank" class="git-source-code"> Browse Source Code</a></p>
<h3>1. Update the Pins Controller</h3>
<p class="text-muted"><em>app/controllers/pins_conroller.rb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="kwd">class</span><span class="pln"> </span><span class="typ">PinsController</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="typ">ApplicationController</span><span class="pln">
  before_action </span><span class="pun">:</span><span class="pln">set_pin</span><span class="pun">,</span><span class="pln"> only</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[:</span><span class="pln">show</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">edit</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">update</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">destroy</span><span class="pun">]</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> index
    </span><span class="lit">@pins</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pin</span><span class="pun">.</span><span class="pln">all
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> show
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> </span><span class="kwd">new</span><span class="pln">
    </span><span class="lit">@pin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> current_user</span><span class="pun">.</span><span class="pln">pins</span><span class="pun">.</span><span class="pln">build
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> edit
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> create
    </span><span class="lit">@pin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> current_user</span><span class="pun">.</span><span class="pln">pins</span><span class="pun">.</span><span class="pln">build</span><span class="pun">(</span><span class="pln">pin_params</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="lit">@pin</span><span class="pun">.</span><span class="pln">save
      redirect_to </span><span class="lit">@pin</span><span class="pun">,</span><span class="pln"> notice</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Pin was successfully created.'</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
      render :new</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> update
    </span><span class="kwd">if</span><span class="pln"> </span><span class="lit">@pin</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">pin_params</span><span class="pun">)</span><span class="pln">
      redirect_to </span><span class="lit">@pin</span><span class="pun">,</span><span class="pln"> notice</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Pin was successfully updated.'</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
      render :edit</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">def</span><span class="pln"> destroy
    </span><span class="lit">@pin</span><span class="pun">.</span><span class="pln">destroy
    redirect_to pins_url
  </span><span class="kwd">end</span><span class="pln">

  </span><span class="kwd">private</span><span class="pln">
    </span><span class="com"># Use callbacks to share common setup or constraints between actions.</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> set_pin
      </span><span class="lit">@pin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pin</span><span class="pun">.</span><span class="pln">find_by</span><span class="pun">(id: </span><span class="kwd">params</span><span class="pun">[:</span><span class="pln">id</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> correct_user
      </span><span class="lit">@pin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> current_user</span><span class="pun">.</span><span class="pln">pins</span><span class="pun">.</span><span class="pln">find_by</span><span class="pun">(</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">params</span><span class="pun">[:</span><span class="pln">id</span><span class="pun">])</span><span class="pln">
      redirect_to pins_path</span><span class="pun">,</span><span class="pln"> notice</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Not authorized to edit this pin"</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="lit">@pin</span><span class="pun">.</span><span class="kwd">nil</span><span class="pun">?</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">

    </span><span class="com"># Never trust parameters from the scary internet, only allow the white list through.</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> pin_params
      </span><span class="kwd">params</span><span class="pun">.</span><span class="kwd">require</span><span class="pun">(:</span><span class="pln">pin</span><span class="pun">).</span><span class="pln">permit</span><span class="pun">(:</span><span class="pln">description</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">image</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span></code></pre>
<h3>2. Update the pins view <a href="#" onclick="wistiaEmbed.time(390);return true;" rel="tooltip" data-placement="right" title="" data-original-title="Jump to 6:30"><i class="icon-time"></i></a></h3>
<p class="text-muted"><em>app/views/pins/index.html.erb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pun">&lt;%=</span><span class="pln"> pin</span><span class="pun">.</span><span class="pln">user</span><span class="pun">.</span><span class="pln">email </span><span class="kwd">if</span><span class="pln"> pin</span><span class="pun">.</span><span class="pln">user %&gt;</span></code></pre>
<p>Or alternatively you could the Ruby <a href="http://api.rubyonrails.org/classes/Object.html" target="_blank">"try"</a> method&hellip;.</p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pun">&lt;%=</span><span class="pln"> pin</span><span class="pun">.</span><span class="pln">user</span><span class="pun">.</span><span class="kwd">try</span><span class="pun">(:</span><span class="pln">email</span><span class="pun">)</span><span class="pln"> %&gt;</span></code></pre>
(I don't choose this one, but it's good to know about)
<h3>3. Add devise User authentication <a href="#" onclick="wistiaEmbed.time(599);return true;" rel="tooltip" data-placement="right" title="" data-original-title="Jump to 9:59"><i class="icon-time"></i></a></h3>
<p>Resource: <a href="https://github.com/plataformatec/devise" target="_blank">https://github.com/plataformatec/devise</a></p>
<p>Add the before_action to your Pins Controller</p>
<p><em>app/controllers/pins_conroller.rb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pln">before_action </span><span class="pun">:</span><span class="pln">authenticate_user</span><span class="pun">!,</span><span class="pln"> </span><span class="kwd">except</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[:</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">show</span><span class="pun">]</span></code></pre>
<h3>4. Surround the edit link with an "if" conditional</h3>
<p>This way you can only see your pins. To put that another way: A user can only see his pins (and not other user's pins). Make sense?</p>
<p class="text-muted"><em>app/views/pins/index.html.erb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pun">...</span><br /><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> pin</span><span class="pun">.</span><span class="pln">user </span><span class="pun">==</span><span class="pln"> current_user </span><span class="pun">%&gt;</span><br /><span class="pln">&nbsp;&nbsp;</span><span class="pun">&lt;%=</span><span class="pln"> link_to </span><span class="str">'Edit'</span><span class="pun">,</span><span class="pln"> edit_pin_path</span><span class="pun">(</span><span class="pln">pin</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%&gt;</span><br /></code><code class="perl prettyprint lang-scm prettyprinted"><span class="pln">  </span><span class="pun">&lt;</span><span class="variable"><span class="pun">%=</span></span><span class="pln"> link_to </span><span class="string"><span class="str">'Destroy'</span></span><span class="pun">,</span><span class="pln"> pin</span><span class="pun">,</span><span class="pln"> method</span><span class="pun">:</span><span class="pln"> </span><span class="pun">:</span><span class="keyword"><span class="kwd">delete</span></span><span class="pun">,</span><span class="pln"> data</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> confirm</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'Are you sure?'</span></span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="variable"><span class="pln">%&gt;</span><br /><code class="prettyprint lang-scm"><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">end</span><span class="pln"> %&gt;</span><br /></code><span class="pln">...</span></span></code></pre>
<p class="text-muted"><em>app/views/pins/show.html.erb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pun">...</span><br /><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="lit">@pin</span><span class="pun">.</span><span class="pln">user </span><span class="pun">==</span><span class="pln"> current_user </span><span class="pun">%&gt;</span><br /><span class="pln">&nbsp;&nbsp;</span><span class="pun">&lt;%=</span><span class="pln"> link_to </span><span class="str">'Edit'</span><span class="pun">,</span><span class="pln"> edit_pin_path</span><span class="pun">(</span><span class="lit">@pin</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%&gt;</span></code><code class="perl prettyprint lang-scm prettyprinted"><span class="variable"><br /><code class="prettyprint lang-scm"><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">end</span><span class="pln"> %&gt;
</span><span class="pun">&lt;</span><span class="variable"><span class="pun">%=</span></span><span class="pln"> link_to </span><span class="str">'Back'</span><span class="pun">,</span><span class="pln"> pins_path %&gt;</span><span class="variable"></span><br /></code><span class="pln">...</span></span></code></pre>
<h3>5. Add correct_user method</h3>
<p>Add the before_action to your Pins Controller</p>
<p><em>app/controllers/pins_conroller.rb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pln">before_action </span><span class="pun">:</span><span class="pln">correct_user</span><span class="pun">,</span><span class="pln"> only</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[:</span><span class="pln">edit</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">update</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:</span><span class="pln">destroy</span><span class="pun">]</span></code></pre>
<h3>6. Surround the "New Pin" link with an "if" conditional</h3>
<p class="text-muted"><em>app/views/pins/index.html.erb</em></p>
<pre><code class="prettyprint lang-scm prettyprinted"><span class="pun">...</span><br /><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> user_signed_in</span><span class="pun">?</span><span class="pln"> </span><span class="pun">%&gt;</span><br /><span class="pln">&nbsp;&nbsp;</span><span class="pun">&lt;%=</span><span class="pln"> link_to </span><span class="str">'New Pin'</span><span class="pun">,</span><span class="pln"> new_pin_path </span><span class="pun">%&gt;</span><span class="pln">
</span><span class="pun">&lt;%</span><span class="pln"> </span><span class="kwd">end</span><span class="pln"> </span><span class="pun">%&gt;</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<h4>Bonus! Helpful commands</h4>
<pre><code>$ git add --all<br /></code>$ git commit -am "commit message"<br />$ git push<br />$ git push heroku master<br />$ heroku open</pre>
<p></p>
          </div>

        </div>

        <div class="tab-pane" id="troubleshooting">
            <h4>Q: Why do we sometimes use @ before variable names? <a href="#" onclick="wistiaEmbed.time(1159);return true;" rel="tooltip" data-placement="right" title="" data-original-title="Jump to 19:19"><i class="icon-time"></i></a></h4>
<p>We have to use a <code class="prettyprint lang-scm prettyprinted"><span class="pun">@</span></code> symbol before pins because we are pulling it from the controller. In a previous example in <em class="text-muted">app/views/pins/index.html.erb</em> we just used <code class="prettyprint lang-scm prettyprinted"><span class="pln">pins</span><span class="pun">.</span><span class="pln">user</span></code> without the symbol because it was already assigned (in the loop above on line #15: <code class="prettyprint lang-scm prettyprinted"><span class="pun">&lt;%</span><span class="pln"> </span><span class="lit">@pins</span><span class="pun">.</span><span class="pln">each </span><span class="kwd">do</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pin</span><span class="pun">|</span><span class="pln"> %&gt;</span></code>)</p>
        </div>

        <div class="tab-pane" id="comments">
          <h3>28 Questions</h3>
          <p>Having trouble? Don't worry, you're probably not the only one. Check out the questions other students have or ask yours.</p>
            <p><a target="blank" href="http://community.onemonth.com/t/nameerror-undefined-local-variable-or-method-current-user">NameError: undefined local variable or method `current_user&#39;</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/error-when-creating-new-pin-on-heroku-works-fine-locally">Error when creating new Pin on Heroku - works fine locally</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/param-is-missing-or-the-value-is-empty-pin">Param is missing or the value is empty: pin</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nameerror-uninitialized-constant-pin">NameError: uninitialized constant Pin</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/db-migration-to-heroku">DB migration to heroku</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/pin-controller-issues-nomethoderror">Pin Controller Issues - &quot;NoMethodError&quot;</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/confirmation-for-destroy-still-not-working">Confirmation for Destroy still not working</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/how-can-i-delete-pins-that-exist-on-heroku-but-not-my-local-server">How can I delete pins that exist on heroku, but not my local server?</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/flash-message-shown-twice">Flash message shown twice</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nomethoderror-in-pinscontroller-new">NoMethodError in PinsController#new</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/hiding-edit-destroy-links-for-orphan-pins-when-not-logged-in">Hiding edit/destroy links for orphan pins when not logged in</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/deleting-pins-through-command-pad-gitbash">Deleting Pins through command pad (GitBash)</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/hiding-the-edit-and-destroy-buttons-when-not-signed-in">Hiding the &quot;edit&quot; and &quot;destroy&quot; buttons, when not signed in?</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/trouble-with-pins-http-localhost-3000-pins-new">Trouble with pins http://localhost:3000/pins/new</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/4-15-4-17-of-video-nomethoderror-undefined-method-pins-for-nil-nilclass">4:15 - 4:17 of Video - NoMethodError: undefined method `pins&#39; for nil:NilClass</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nameerror-in-pinscontroller-new">NameError in PinsController#new</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/day-23-lesson-1-5-32mins-in-nomethoderror-in-pins-index">Day 23, lesson 1 @5:32mins in. &quot;NoMethodError in Pins#index&quot;</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/day-23-lesson-1-5-32mins-in-nomethoderror-in-pins-index">Day 23, lesson 1 @ 5:32mins in. &quot;NoMethodError in Pins#index&quot;</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/day-23-authorization-user-pins-error">Day 23: Authorization- @user.pins error</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nomethoderror-in-pins-index-2">NoMethodError in Pins#index#2</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nomethoderror-in-pins-index">NoMethodError in Pins#index</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/listing-pins-not-aligned-correctly">Listing pins not aligned correctly</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/migrations-are-pending-to-resolve-this-issue-run-bin-rake-db-migrate-rails-env-development">Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/email-address-is-in-the-wrong-spot">Email address is in the wrong spot</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/nomethoderror-in-pinscontroller-edit">NoMethodError in PinsController#edit</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/day-23-i-found-a-fix-to-an-authentication-problem-but-why">Day 23: I found a fix to an authentication problem, but why?</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/day-23-minute-19-20-on-the-video-when-i-change-1-for-3-i-get-an-error-message">Day 23, minute 19:20 on the video. When I change &quot;1&quot; for &quot;3&quot; I get an error message</a></p>
            <p><a target="blank" href="http://community.onemonth.com/t/unable-to-get-past-day-23-authorization-on-one-month-ruby">Unable to get past Day 23: Authorization on One Month Ruby</a></p>
          <p><a class="btn btn-primary" target="blank" href="http://community.onemonth.com/category/rails/day-23/create">Ask A Question</a></p>
        </div>
      </div>
    </div>
  </div>

      <header class="navbar navbar-default navbar-bottom minimal-footer" role="navigation", style="background: rgba(255, 255, 255, 0.9); background-color: rgba (255,255,255,0.9); border-top:none;" >
    <div class="container-fluid">
      <div class="footer-wrapper">
        <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <!-- logo -->
      <a class="navbar-brand" href="/" style="padding-right: 8px;">
        <img class="navbar-brand-icon" style="height: 16px;" src="https://d3dcc53t14pv6.cloudfront.net/assets/dark-logo-@2x-4aa30f32b5bea4ced1e84c96a45bf384.png" alt="Dark logo @2x" />
      </a>
      <p class="hidden-sm" style="margin-top:2.3em;"> |&nbsp;&nbsp;Building a better way to learn.</p>
    </div>
    <ul class="nav navbar-nav navbar-right">
      <li><a href="http://jobs.onemonth.com">Careers</a></li>
      <li><a href="https://gorails.com">GoRails Screencasts</a></li>
      <li><a href="/terms-of-use">Terms &amp; Conditions</a></li>
      <li><a href="https://www.iubenda.com/privacy-policy/735465">Privacy Policy</a></li>
    </ul>
      </div>
    </div>
    <div style="text-align: center; margin-top: 0; color: #a6a6a6; font-size:0.85em;">
      <span>© 2013-2015 One Month, Inc.</span>
    </div>
  </header>

    
  <script>
  analytics.track('Watched a step', {
    stepTitle: "Authorization: Who can? Who can't?",
    course: "One Month Rails"
    });
  analytics.identify(OM.user.id, {
    last_step_watched: "Authorization: Who can? Who can't?",
    step_id: 75,
    course_id: 4
    });
  </script>


<script>
    analytics.track("Viewed A Step", {"product":"One Month Rails","step":"Authorization: Who can? Who can't?","percent_complete":66});
</script>

  </body>
</html>
